<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info">












    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            OWASP Juice Shop靶场writeup | 
        
        NeverSec的博客 | 安全不止
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="description" itemprop="description" content="近日在OWASP官网发现了这个靶场，融入了OWASP TOP10的漏洞，感觉好像很好玩，花了好几天的时间自己快速地过了一遍。该WP基于 Juice shop v7.0.2（18年版本）。左上可以点开目录，点击直达。">
    <meta name="keywords" content="渗透测试,CTF">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?YnKWKi7Llh7tGEKEFvFvpQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/tranquil-heart.min.css?ul3p9I9MsbOxK0L+BHzDDg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","https://cdn.bootcss.com/jquery/2.2.1/jquery.js", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="NeverSec的博客 | 安全不止">
    <meta name="msapplication-starturl" content="https://leezj9671.github.io/20180319/OWASP Juice Shop writeup.html">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="NeverSec的博客 | 安全不止">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://leezj9671.github.io/20180319/OWASP Juice Shop writeup.html">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="OWASP Juice Shop靶场writeup | NeverSec的博客 | 安全不止">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="近日在OWASP官网发现了这个靶场，融入了OWASP TOP10的漏洞，感觉好像很好玩，花了好几天的时间自己快速地过了一遍。该WP基于 Juice shop v7.0.2（18年版本）。左上可以点开目录，点击直达。">
    <meta property="og:article:tag" content="CTF"> 

    
        <meta property="article:published_time" content="Mon Mar 19 2018 13:43:11 GMT+0800">
        <meta property="article:modified_time" content="Tue Apr 09 2019 13:50:00 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://leezj9671.github.io/20180319/OWASP Juice Shop writeup.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://leezj9671.github.io/20180319/OWASP Juice Shop writeup.html",
    "headline": "OWASP Juice Shop靶场writeup",
    "datePublished": "Mon Mar 19 2018 13:43:11 GMT+0800",
    "dateModified": "Tue Apr 09 2019 13:50:00 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "n3ver",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "博客搭建中……,Hacking is No Limited"
    },
    "publisher": {
        "@type": "Organization",
        "name": "NeverSec的博客 | 安全不止",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",CTF渗透测试",
    "description": "近日在OWASP官网发现了这个靶场，融入了OWASP TOP10的漏洞，感觉好像很好玩，花了好几天的时间自己快速地过了一遍。该WP基于 Juice shop v7.0.2（18年版本）。左上可以点开目录，点击直达。",
}
</script>


    

    <!-- Analytics -->
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?b3c4d22f885f6f353c15234e03abe245';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    
        <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=UA-137586292-1&web_id=UA-137586292-1" language="JavaScript"></script>
</div>
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn" class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#环境搭建"><span class="post-toc-number">1.</span> <span class="post-toc-text">环境搭建</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#源码NPM安装"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">源码NPM安装</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Docker安装（推荐）"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Docker安装（推荐）</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一星难度"><span class="post-toc-number">2.</span> <span class="post-toc-text">一星难度</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Score-Board-计分板"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">Score Board 计分板</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Admin-Section-管理员页面"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">Admin Section 管理员页面</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Confidential-Document-机密文件"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">Confidential Document 机密文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Error-Handling-错误处理"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">Error Handling 错误处理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redirects-Tier-1-重定向第一关"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">Redirects Tier 1 重定向第一关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XSS-Tier-1-XSS第一关"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">XSS Tier 1 XSS第一关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Zero-Stars-零星评价"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">Zero Stars 零星评价</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#二星难度"><span class="post-toc-number">3.</span> <span class="post-toc-text">二星难度</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Basket-Access-购物车访问"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">Basket Access 购物车访问</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Christmas-Special-圣诞特别礼"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">Christmas Special 圣诞特别礼</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Deprecated-Interface-已弃用的接口"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">Deprecated Interface 已弃用的接口</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Five-Star-Feedback-五星级的反馈"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">Five-Star Feedback 五星级的反馈</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Login-Admin-登陆Admin"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">Login Admin 登陆Admin</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Login-MC-SafeSearch-登陆MC-SafeSearch"><span class="post-toc-number">3.6.</span> <span class="post-toc-text">Login MC SafeSearch 登陆MC SafeSearch</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Password-Strength-密码强度"><span class="post-toc-number">3.7.</span> <span class="post-toc-text">Password Strength 密码强度</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Weird-Crypto-奇怪的加密"><span class="post-toc-number">3.8.</span> <span class="post-toc-text">Weird Crypto 奇怪的加密</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#三星难度"><span class="post-toc-number">4.</span> <span class="post-toc-text">三星难度</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Blockchain-Tier-1-区块链第一关"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">Blockchain Tier 1 区块链第一关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Forged-Feedback-伪造反馈"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">Forged Feedback 伪造反馈</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Forgotten-Sales-Backup-被遗忘的销售备份"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">Forgotten Sales Backup 被遗忘的销售备份</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Login-Bender-登录Bender"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">Login Bender 登录Bender</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Login-Jim-登录Jim"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">Login Jim 登录Jim</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Payback-Time-投资回收期"><span class="post-toc-number">4.6.</span> <span class="post-toc-text">Payback Time 投资回收期</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Product-Tampering-商品篡改"><span class="post-toc-number">4.7.</span> <span class="post-toc-text">Product Tampering 商品篡改</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Reset-Jim’s-Password-重置Jim的密码"><span class="post-toc-number">4.8.</span> <span class="post-toc-text">Reset Jim’s Password 重置Jim的密码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Upload-Size-amp-Upload-Type"><span class="post-toc-number">4.9.</span> <span class="post-toc-text">Upload Size &amp; Upload Type</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XSS-Tier-2-XSS第二关"><span class="post-toc-number">4.10.</span> <span class="post-toc-text">XSS Tier 2 XSS第二关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XSS-Tier-3-XSS第三关"><span class="post-toc-number">4.11.</span> <span class="post-toc-text">XSS Tier 3 XSS第三关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XXE-Tier-1-XXE第一关"><span class="post-toc-number">4.12.</span> <span class="post-toc-text">XXE Tier 1 XXE第一关</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#四星难度"><span class="post-toc-number">5.</span> <span class="post-toc-text">四星难度</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CSRF"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">CSRF</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Easter-Egg-Tier-1-amp-Easter-Egg-Tier-2"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">Easter Egg Tier 1 &amp; Easter Egg Tier 2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Eye-Candy-秀色可餐"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">Eye Candy 秀色可餐</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Forgotten-Developer-Backup-被遗忘的开发者备份"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">Forgotten Developer Backup 被遗忘的开发者备份</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Login-Bjoern-登录Bjoern"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">Login Bjoern 登录Bjoern</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Misplaced-Signature-File-错位的siem签名文件。"><span class="post-toc-number">5.6.</span> <span class="post-toc-text">Misplaced Signature File 错位的siem签名文件。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#NoSQL-Injection-Tier-1-NoSQL注入第一关"><span class="post-toc-number">5.7.</span> <span class="post-toc-text">NoSQL Injection Tier 1 NoSQL注入第一关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#NoSQL-Injection-Tier-2"><span class="post-toc-number">5.8.</span> <span class="post-toc-text">NoSQL Injection Tier 2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redirects-Tier-2-重定向第二关"><span class="post-toc-number">5.9.</span> <span class="post-toc-text">Redirects Tier 2 重定向第二关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Reset-Bender’s-Password-重置Bender的密码"><span class="post-toc-number">5.10.</span> <span class="post-toc-text">Reset Bender’s Password 重置Bender的密码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Typosquatting-Tier-1-域名注册第一关"><span class="post-toc-number">5.11.</span> <span class="post-toc-text">Typosquatting Tier 1 域名注册第一关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#User-Credentials"><span class="post-toc-number">5.12.</span> <span class="post-toc-text">User Credentials</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Vulnerable-Library-有漏洞的库"><span class="post-toc-number">5.13.</span> <span class="post-toc-text">Vulnerable Library 有漏洞的库</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XSS-Tier-4"><span class="post-toc-number">5.14.</span> <span class="post-toc-text">XSS Tier 4</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#五星难度"><span class="post-toc-number">6.</span> <span class="post-toc-text">五星难度</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CAPTCHA-Bypass-验证码绕过"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">CAPTCHA Bypass 验证码绕过</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Extra-Language-额外的语言"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">Extra Language 额外的语言</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#JWT-Issues-Tier-1-JWT问题第一关"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">JWT Issues Tier 1 JWT问题第一关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Login-CISO-登录CISO"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">Login CISO 登录CISO</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#RCE-Tier-1-RCE第一关"><span class="post-toc-number">6.5.</span> <span class="post-toc-text">RCE Tier 1 RCE第一关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Reset-Bjoern’s-Password-重置Bjoern的密码"><span class="post-toc-number">6.6.</span> <span class="post-toc-text">Reset Bjoern’s Password 重置Bjoern的密码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Reset-Morty’s-Password-重置Morty的密码"><span class="post-toc-number">6.7.</span> <span class="post-toc-text">Reset Morty’s Password 重置Morty的密码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Retrieve-Blueprint-检索Blueprint"><span class="post-toc-number">6.8.</span> <span class="post-toc-text">Retrieve Blueprint 检索Blueprint</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Typosquatting-Tier-2-注册近似域名-第二关"><span class="post-toc-number">6.9.</span> <span class="post-toc-text">Typosquatting Tier 2 注册近似域名 第二关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XXE-Tier-2-XXE第二关"><span class="post-toc-number">6.10.</span> <span class="post-toc-text">XXE Tier 2 XXE第二关</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#六星难度"><span class="post-toc-number">7.</span> <span class="post-toc-text">六星难度</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 15 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                OWASP Juice Shop靶场writeup
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar">
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>n3ver</strong>
        <span>3月 19, 2018</span>
    </div>

    <div class="section-spacer"></div>
    
    <i class="material-icons">keyboard</i><span class="post-count" style="margin-right:5px">本文共:7.2k字  </span>
    <i class="material-icons">query_builder</i><span class="post-count">阅读时间≈30分  </span>
    
    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/CTF/">CTF</a>
    </li></ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=OWASP Juice Shop靶场writeup&url=https://leezj9671.github.io/20180319/OWASP Juice Shop writeup.html&pic=https://leezj9671.github.io/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=NeverSec的博客 | 安全不止&title=OWASP Juice Shop靶场writeup&summary=网络安全,渗透测试,CTF&pics=https://leezj9671.github.io/img/favicon.png&url=https://leezj9671.github.io/20180319/OWASP Juice Shop writeup.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>近日在OWASP官网发现了这个靶场，融入了OWASP TOP10的漏洞，感觉好像很好玩，花了好几天的时间自己快速地过了一遍。该WP基于 Juice shop v7.0.2（18年版本）。左上可以点开目录，点击直达。</p>
<a id="more"></a>
<p>有人说为啥网上writeup都有了要看你的？因为很多wp说的都不清晰不全，大部分还是英文，我在写wp的时候会尽量把知识点写得更清晰，其次，这个靶场更新很快，很多新题目网上都没有wp，我也尽量给上自己的思路和理解。欢迎提出修改意见~</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>官方的Github源码链接为 <a href="https://github.com/bkimminich/juice-shop/" target="_blank" rel="noopener">https://github.com/bkimminich/juice-shop/</a></p>
<h3 id="源码NPM安装"><a href="#源码NPM安装" class="headerlink" title="源码NPM安装"></a>源码NPM安装</h3><p>注意 Node8 和 Node9 有所不同，具体可见github的安装指南。以下是9的安装步骤</p>
<ol>
<li>安装 <a href="#nodejs-version-compatibility">node.js</a></li>
<li>下载源码 <code>git clone https://github.com/bkimminich/juice-shop.git</code></li>
<li><code>cd juice-shop</code></li>
<li><code>npm install</code></li>
<li>运行 <code>npm start</code></li>
<li>访问 <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> 即可。如果需要</li>
</ol>
<h3 id="Docker安装（推荐）"><a href="#Docker安装（推荐）" class="headerlink" title="Docker安装（推荐）"></a>Docker安装（推荐）</h3><p>之所以推荐这个是因为挂掉了或者是重新开始也能很快地搭建环境。docker使用非常简单：</p>
<ol>
<li>安装 <a href="https://www.docker.com" target="_blank" rel="noopener">Docker</a></li>
<li>拉取镜像 <code>docker pull bkimminich/juice-shop</code></li>
<li>运行容器 <code>docker run -d -p 3000:3000 bkimminich/juice-shop</code></li>
<li>访问 <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> （遇到问题可以到Github上面看看安装指南）</li>
</ol>
<h2 id="一星难度"><a href="#一星难度" class="headerlink" title="一星难度"></a>一星难度</h2><h3 id="Score-Board-计分板"><a href="#Score-Board-计分板" class="headerlink" title="Score Board 计分板"></a>Score Board 计分板</h3><blockquote>
<p>Find the carefully hidden ‘Score Board’ page.找到仔细隐藏的“评分板”页面</p>
</blockquote>
<p>对于新手来说，根据这个页面可以让自己有目标地进行挖洞，也是让自己有成就感的一种方式。:&gt; </p>
<p>接下来gogogo：</p>
<p>在首页源代码发现了注释的一块代码：</p>
<p><img src="https://i.loli.net/2018/04/19/5ad8767c8c187.jpg" alt></p>
<p>访问该页面 <code>/#/score-board</code> 会跳到计分板，里面有各个难度的说明</p>
<p><img src="https://i.loli.net/2018/04/19/5ad876adaed5f.jpg" alt></p>
<h3 id="Admin-Section-管理员页面"><a href="#Admin-Section-管理员页面" class="headerlink" title="Admin Section 管理员页面"></a>Admin Section 管理员页面</h3><blockquote>
<p>Access the administration section of the store. 访问商店的管理页面。</p>
</blockquote>
<p>找到后台管理页面。御剑走一波扫不出来，根据描述猜解访问了 <a href="http://192.168.209.146:3000/administration" target="_blank" rel="noopener">http://192.168.209.146:3000/administration</a>，结果发现不行，重新输入 <a href="http://192.168.209.146:3000/#/administration" target="_blank" rel="noopener">http://192.168.209.146:3000/#/administration</a> 访问成功</p>
<p><img src="https://i.loli.net/2018/04/19/5ad87cb205097.jpg" alt></p>
<p>结果完成了两个（挠头）</p>
<h3 id="Confidential-Document-机密文件"><a href="#Confidential-Document-机密文件" class="headerlink" title="Confidential Document 机密文件"></a>Confidential Document 机密文件</h3><blockquote>
<p>Access a confidential document. 访问机密文件</p>
</blockquote>
<p>看到这个一开始不知道哪儿有，搁置了一边之后在中途看到了这个链接：</p>
<p><img src="https://i.loli.net/2018/04/19/5ad883f7cc1dd.jpg" alt></p>
<p>可能是因为中文的原因，这一行真的太明显了吧。。点开链接 <a href="http://192.168.209.146:3000/ftp/legal.md?md_debug=true" target="_blank" rel="noopener">http://192.168.209.146:3000/ftp/legal.md?md_debug=true</a></p>
<p>访问<a href="http://192.168.209.146:3000/ftp" target="_blank" rel="noopener">http://192.168.209.146:3000/ftp</a> 发现可以直接访问其ftp目录</p>
<p>点开一些文件提示<code>403 Error: Only .md and .pdf files are allowed!</code>，这个点是访问了第一个md文件就可以过了。此处还发现了一些bak文件，这个漏洞下面会说到</p>
<h3 id="Error-Handling-错误处理"><a href="#Error-Handling-错误处理" class="headerlink" title="Error Handling 错误处理"></a>Error Handling 错误处理</h3><blockquote>
<p>Provoke an error that is not very gracefully handled. 提出一个不太适合处理的错误。</p>
</blockquote>
<p>题目的意思是寻找出报错页面，由于上面莫名其妙完成了有点不知所以，docker重置了一波环境，在登录处看到了报错：<br><img src="https://i.loli.net/2018/04/19/5ad8817c6de94.jpg" alt></p>
<p>报错后即可完成</p>
<h3 id="Redirects-Tier-1-重定向第一关"><a href="#Redirects-Tier-1-重定向第一关" class="headerlink" title="Redirects Tier 1 重定向第一关"></a>Redirects Tier 1 重定向第一关</h3><blockquote>
<p>Let us redirect you to a donation site that went out of business. 让我们将您重定向至停业的捐赠网站。</p>
</blockquote>
<p>后续测试过程在购物车页面找到注释的重定向网址，实在是太猥琐了</p>
<p><img src="https://i.loli.net/2018/04/19/5ad890db82b82.jpg" alt></p>
<h3 id="XSS-Tier-1-XSS第一关"><a href="#XSS-Tier-1-XSS第一关" class="headerlink" title="XSS Tier 1 XSS第一关"></a>XSS Tier 1 XSS第一关</h3><blockquote>
<p>Perform a reflected XSS attack with <script>alert(“XSS”)</script>. 执行反射 XSS攻击<code>&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;</code>。</p>
</blockquote>
<p>搜索框直接可以弹，闭合了反而没有提示完成，略坑=。=</p>
<h3 id="Zero-Stars-零星评价"><a href="#Zero-Stars-零星评价" class="headerlink" title="Zero Stars 零星评价"></a>Zero Stars 零星评价</h3><blockquote>
<p>Give a devastating zero-star feedback to the store. 给商店带来毁灭性的零星反馈。</p>
</blockquote>
<p>评价链接位于 联系我们 <a href="http://192.168.209.146:3001/#/contact" target="_blank" rel="noopener">http://192.168.209.146:3001/#/contact</a>，burp改包可过<br><img src="https://i.loli.net/2018/04/19/5ad8869a7526d.jpg" alt></p>
<h2 id="二星难度"><a href="#二星难度" class="headerlink" title="二星难度"></a>二星难度</h2><h3 id="Basket-Access-购物车访问"><a href="#Basket-Access-购物车访问" class="headerlink" title="Basket Access 购物车访问"></a>Basket Access 购物车访问</h3><blockquote>
<p>Access someone else’s basket. 访问他人的购物车</p>
</blockquote>
<p>修改会话存储的bid，访问购物车即可<br><img src="https://i.loli.net/2018/04/19/5ad895e3ca579.jpg" alt></p>
<h3 id="Christmas-Special-圣诞特别礼"><a href="#Christmas-Special-圣诞特别礼" class="headerlink" title="Christmas Special 圣诞特别礼"></a>Christmas Special 圣诞特别礼</h3><blockquote>
<p>Order the Christmas special offer of 2014. 订购2014年的圣诞特供</p>
</blockquote>
<p>搜索框SQL注入。抓包回显了报错语句，明显有SQL注入</p>
<p><img src="https://i.loli.net/2018/04/19/5ad899a85c484.jpg" alt></p>
<p>分析语句，构造payload为<code>q=&#39;))--</code>可以查询出所有商品，添加2014的圣诞特供商品即可</p>
<h3 id="Deprecated-Interface-已弃用的接口"><a href="#Deprecated-Interface-已弃用的接口" class="headerlink" title="Deprecated Interface 已弃用的接口"></a>Deprecated Interface 已弃用的接口</h3><blockquote>
<p>Use a deprecated B2B interface that was not properly shut down.  使用未正确关闭的废弃的B2B接口。</p>
</blockquote>
<p>B2B接口不清楚是什么，但是在<a href="http://192.168.209.146:3001/#/complain" target="_blank" rel="noopener">http://192.168.209.146:3001/#/complain</a>页面中有一段注释掉的代码写着B2B，这个地方也可以上传xml文件，但是限定了只能从电脑选择pdf文件。</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9d03574136.jpg" alt><br><img src="https://i.loli.net/2018/04/20/5ad9d1671217e.jpg" alt></p>
<p>然而还是可以选xml文件进行上传</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9d2d2a35c7.jpg" alt></p>
<p>上传后返回了<code>410</code>状态码，但是挑战也成功了。</p>
<blockquote>
<p>410：被请求的资源在服务器上已经不再可用，而且没有任何已知的转发地址。410响应的目的主要是帮助网站管理员维护网站，通知用户该资源已经不再可用，并且服务器拥有者希望所有指向这个资源的远端连接也被删除。</p>
</blockquote>
<h3 id="Five-Star-Feedback-五星级的反馈"><a href="#Five-Star-Feedback-五星级的反馈" class="headerlink" title="Five-Star Feedback 五星级的反馈"></a>Five-Star Feedback 五星级的反馈</h3><blockquote>
<p>Get rid of all 5-star customer feedback. 删掉所有的5星客户评价</p>
</blockquote>
<p>在<a href="http://192.168.209.146:3000/#/administration" target="_blank" rel="noopener">http://192.168.209.146:3000/#/administration</a>页面上，修改bid为1，即可删除<br><img src="https://i.loli.net/2018/04/20/5ad99ac091821.jpg" alt></p>
<h3 id="Login-Admin-登陆Admin"><a href="#Login-Admin-登陆Admin" class="headerlink" title="Login Admin 登陆Admin"></a>Login Admin 登陆Admin</h3><blockquote>
<p>Log in with the administrator’s user account. 使用管理员用户账号登陆</p>
</blockquote>
<p>只能是sql注入了。回到登陆框，抓包看到提交的数据为<code>{&quot;email&quot;:&quot;\&quot; or 1=1--&quot;,&quot;password&quot;:&quot;123&quot;}</code>，结合sql语句 <code>SELECT * FROM Users WHERE email = &#39;1&#39;&#39; AND password = &#39;202cb962ac59075b964b07152d234b70</code>，payload为 <code>email&quot;:&quot;&#39; or 1=1 --&quot;,&quot;password&quot;:&quot;123&quot;</code>即可使用管理员登陆。原因是管理员的数据在select结果处于第一位。</p>
<h3 id="Login-MC-SafeSearch-登陆MC-SafeSearch"><a href="#Login-MC-SafeSearch-登陆MC-SafeSearch" class="headerlink" title="Login MC SafeSearch 登陆MC SafeSearch"></a>Login MC SafeSearch 登陆MC SafeSearch</h3><blockquote>
<p>Log in with MC SafeSearch’s original user credentials without applying SQL Injection or any other bypass. 使用MC SafeSearch的原始用户凭据登录，无需应用SQL注入或任何其他旁路。</p>
</blockquote>
<p>一开始以为是注入，但是题目写了不用注入，最后我也没想到是社工，搜索了一波才知道。</p>
<p>首先有sql注入的话用户都可以枚举，我手动测试了一下，发现<code>{&quot;email&quot;:&quot;&#39; or 1=1 limit 7,1 --&quot;,&quot;password&quot;:&quot;123&quot;}</code> 就是MC SafeSearch的邮箱 <a href="mailto:`mc.safesearch@juice-sh.op" target="_blank" rel="noopener">`mc.safesearch@juice-sh.op</a>`，使用该payload。</p>
<p>谷歌搜索 MC SafeSearch ，发现一个Rapper唱的关于密码强度的MV</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9b4e9c53fc.jpg" alt></p>
<p>播放视频开始切克闹，发现关键信息</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9b543373eb.jpg" alt></p>
<p>于 <a href="https://www.youtube.com/watch?v=v59CX2DiX0Y" target="_blank" rel="noopener">视频 0:25</a> 表示了使用宠物的名字 <code>Mr.Noodles</code>作为密码，然后将一些字母变成了0，一般习惯是将 o 变成 0，所以密码就是 <code>Mr. N00dles</code>。坑点之处在密码中间要加空格，令人头大。</p>
<h3 id="Password-Strength-密码强度"><a href="#Password-Strength-密码强度" class="headerlink" title="Password Strength 密码强度"></a>Password Strength 密码强度</h3><blockquote>
<p>Log in with the administrator’s user credentials without previously changing them or applying SQL Injection. 使用管理员的用户凭证登录，而不必事先更改或应用SQL注入。</p>
</blockquote>
<p>题目是密码强度，考察点是弱密码。购物篮中有管理员邮箱<a href="mailto:`admin@juice-sh.op" target="_blank" rel="noopener">`admin@juice-sh.op</a>`，使用burp爆破即可，注意爆破速度不要过快，很容易扫挂掉</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9b28d7e179.jpg" alt></p>
<h3 id="Weird-Crypto-奇怪的加密"><a href="#Weird-Crypto-奇怪的加密" class="headerlink" title="Weird Crypto 奇怪的加密"></a>Weird Crypto 奇怪的加密</h3><blockquote>
<p>Inform the shop about an algorithm or library it should definitely not use the way it does. 告知商店一个算法或库，它绝对不应该使用它的方式。</p>
</blockquote>
<p>在 <a href="http://192.168.209.146:3000/#/contact" target="_blank" rel="noopener">http://192.168.209.146:3000/#/contact</a> 提交一个不安全的算法。<br>这个答案一共有5个：z85 base85 base64 md5 hashid ，提交一个即可。</p>
<ul>
<li>md5: 数据库里面的密码是md5</li>
<li>base64: google accounts注册时密码用的b64传输</li>
<li>z85/hashid/base85: 六星难度题目出现的算法，后边会讲到</li>
</ul>
<h2 id="三星难度"><a href="#三星难度" class="headerlink" title="三星难度"></a>三星难度</h2><h3 id="Blockchain-Tier-1-区块链第一关"><a href="#Blockchain-Tier-1-区块链第一关" class="headerlink" title="Blockchain Tier 1 区块链第一关"></a>Blockchain Tier 1 区块链第一关</h3><blockquote>
<p>Learn about the Token Sale before its official announcement. 在官方宣布前了解一下Token销售</p>
</blockquote>
<p>看到题目一怔，是跟区块链比特币有关呢，仔细看了几遍hint。。这个题目暂时搁置了一会儿。</p>
<p>后续在做其他题目的时候看到了 <a href="http://192.168.209.146:3001/dist/juice-shop.min.js" target="_blank" rel="noopener">http://192.168.209.146:3001/dist/juice-shop.min.js</a> 这个js文件，搜索<code>token</code>发现里面存在题干关键的<code>Token Sale</code>这个词。关键代码如下：</p>
<p><img src="https://i.loli.net/2018/04/21/5adadb71ac0a1.jpg" alt></p>
<p>粘贴这段代码到控制台运行一波</p>
<p><img src="https://i.loli.net/2018/04/21/5adae1d19cc03.jpg" alt></p>
<p>访问这个地址就完成题目了，这道题的意思应该是掩饰了一下地址吧，没太懂<br><img src="https://i.loli.net/2018/04/21/5adadc4fc9bfc.jpg" alt></p>
<p>这个地址里面有一些关于区块链ICO白皮书之类的东西，看到这个调侃笑死我了哈哈哈</p>
<p><img src="https://i.loli.net/2018/04/21/5adae376dd0d5.jpg" alt></p>
<h3 id="Forged-Feedback-伪造反馈"><a href="#Forged-Feedback-伪造反馈" class="headerlink" title="Forged Feedback 伪造反馈"></a>Forged Feedback 伪造反馈</h3><blockquote>
<p>Post some feedback in another users name. 用其他人的用户提交反馈</p>
</blockquote>
<p>在<a href="http://192.168.209.146:3001/#/contact" target="_blank" rel="noopener">http://192.168.209.146:3001/#/contact</a>中提交评价的时候抓包改包，将<code>UserId</code>改成其它即可。</p>
<h3 id="Forgotten-Sales-Backup-被遗忘的销售备份"><a href="#Forgotten-Sales-Backup-被遗忘的销售备份" class="headerlink" title="Forgotten Sales Backup 被遗忘的销售备份"></a>Forgotten Sales Backup 被遗忘的销售备份</h3><blockquote>
<p>Access a salesman’s forgotten backup file. 进入到售货员遗忘的备份文件</p>
</blockquote>
<p>在第一关的 <code>Confidential Document 机密文件</code>题目中找到了一个ftp目录，并且该目录限定了只能查看 md 和 pdf 后缀的文件，在这里可以使用%00截断判断下载文件。其他文件同理。</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9dade1ece9.jpg" alt></p>
<h3 id="Login-Bender-登录Bender"><a href="#Login-Bender-登录Bender" class="headerlink" title="Login Bender 登录Bender"></a>Login Bender 登录Bender</h3><blockquote>
<p>Log in with Bender’s user account.</p>
</blockquote>
<p>利用SQL注入即可，payload 为<code>email&quot;:&quot;&#39; or 1=1 limit 5,1 --&quot;,&quot;password&quot;:&quot;123</code> ，修改limit的序列即可</p>
<h3 id="Login-Jim-登录Jim"><a href="#Login-Jim-登录Jim" class="headerlink" title="Login Jim 登录Jim"></a>Login Jim 登录Jim</h3><blockquote>
<p>Log in with Jim’s user account.</p>
</blockquote>
<p>同上</p>
<h3 id="Payback-Time-投资回收期"><a href="#Payback-Time-投资回收期" class="headerlink" title="Payback Time 投资回收期"></a>Payback Time 投资回收期</h3><blockquote>
<p>Place an order that makes you rich. 下一个令你富有的订单。</p>
</blockquote>
<p>商品加车漏洞。添加购物车的时候抓包，修改POST数据 <code>{&quot;ProductId&quot;:8,&quot;BasketId&quot;:&quot;10&quot;,&quot;quantity&quot;:1}</code> 中的quantity为负数，加车后结账金额为负数。</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9ebf05e0f5.jpg" alt></p>
<h3 id="Product-Tampering-商品篡改"><a href="#Product-Tampering-商品篡改" class="headerlink" title="Product Tampering 商品篡改"></a>Product Tampering 商品篡改</h3><blockquote>
<p>Change the href of the link within the OWASP SSL Advanced Forensic Tool (O-Saft) product description into <a href="http://kimminich.de" target="_blank" rel="noopener">http://kimminich.de</a>. 将owasp ssl高级取证工具（o-saft）产品描述中的链接的href更改为<a href="http://kimminich.de。" target="_blank" rel="noopener">http://kimminich.de。</a></p>
</blockquote>
<p>要改产品描述。访问首页，点击一个商品，在Chrome里面选择XHR请求，有几个个API接口，其中有一个包含描述信息的链接如下</p>
<p><a href="http://192.168.209.146:3001/api/Products/1?d=Fri%20Apr%2020%202018" target="_blank" rel="noopener">http://192.168.209.146:3001/api/Products/1?d=Fri%20Apr%2020%202018</a> d后面跟的是时间参数，不加的话好像是返回最新修改日期</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9f43feedfd.jpg" alt></p>
<p>如果API接口使用了PUT或者DELETE这些危险的HTTP方法的话，数据就很容易被修改。这里试了一下PUT请求，结果是可以搞定的。使用火狐插件 RESTclient ，记得加HTTP头指定类型为 json ，注意要使用<code>{&quot;description&quot;: &quot;TEST&quot;}</code>而不能是<code>{&quot;data&quot;:{&quot;description&quot;: &quot;TEST&quot;}}</code></p>
<p><img src="https://i.loli.net/2018/04/20/5ad9f5aa365ff.jpg" alt></p>
<p>所以最后的payload为<code>{&quot;description&quot;: &quot;&lt;a href=\&quot;http://kimminich.de\&quot;&gt;&lt;/a&gt;&quot;}</code></p>
<h3 id="Reset-Jim’s-Password-重置Jim的密码"><a href="#Reset-Jim’s-Password-重置Jim的密码" class="headerlink" title="Reset Jim’s Password 重置Jim的密码"></a>Reset Jim’s Password 重置Jim的密码</h3><blockquote>
<p>Reset Jim’s password via the Forgot Password mechanism with the original answer to his security question. 通过忘记密码来重置Jim的密码，要求回答他的安全问题</p>
</blockquote>
<p>首先通过登陆的SQL注入<code>{&quot;email&quot;:&quot;&#39; or 1=1 limit 1,1 --&quot;,&quot;password&quot;:&quot;123&quot;}</code>搞到邮箱号， <a href="mailto:jim@juice-sh.op" target="_blank" rel="noopener">jim@juice-sh.op</a>。问的安全问题是<code>Your eldest siblings middle name?</code>，这道题没法儿社工啊。</p>
<p>这道题懵逼了，查了别人的解题说是美国的社工？提到JIM会想起 <em>James T. Kirk</em> ？反正我搜JIM只能搜到 <em>Jim Parsons</em> ( <em>Sheldon</em> 扮演者233)</p>
<p>所以正确的解答路径是</p>
<ol>
<li>想到 <em>James_T._Kirk</em> ，到Wiki上搜他<a href="https://en.wikipedia.org/wiki/James_T._Kirk" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/James_T._Kirk</a></li>
<li>上面写着Jim有个Brother叫 <em>George Samuel Kirk</em></li>
<li>所以安全问题的答案就是 <em>Samuel</em></li>
<li>重置密码，收工。</li>
</ol>
<h3 id="Upload-Size-amp-Upload-Type"><a href="#Upload-Size-amp-Upload-Type" class="headerlink" title="Upload Size &amp; Upload Type"></a>Upload Size &amp; Upload Type</h3><blockquote>
<p>Upload a file larger than 100 kB.Upload a file that has no .pdf extension. 上传一个文件大于100kb，上传一个文件不用pdf扩展名</p>
</blockquote>
<p>两道题在一块儿写。文件上传跟前面说到的上传XML是同一个点，位于投诉页面。尝试提交，查看XHR请求，很明显有个接口 <a href="http://192.168.209.146:3001/file-upload" target="_blank" rel="noopener">http://192.168.209.146:3001/file-upload</a> 是用于文件上传的。</p>
<p>此处先用burp截断，点击上传，提示</p>
<p><img src="https://i.loli.net/2018/04/21/5adaa13d69345.jpg" alt></p>
<p>burp处没有收到请求，说明是前端校验，因此用改包、写脚本等方法直接post到上传接口处即可。</p>
<p>扩展名绕过可以用<code>%2500</code>截断，也可以用如上的方法。</p>
<p><img src="https://i.loli.net/2018/04/21/5adaa0e536f6e.jpg" alt></p>
<h3 id="XSS-Tier-2-XSS第二关"><a href="#XSS-Tier-2-XSS第二关" class="headerlink" title="XSS Tier 2 XSS第二关"></a>XSS Tier 2 XSS第二关</h3><blockquote>
<p>Perform a persisted XSS attack with <script>alert(“XSS”)</script> bypassing a client-side security mechanism. 绕过客户端安全机制执行存储型 XSS攻击。<script>alert(“XSS”)</script></p>
</blockquote>
<p>xss的输入点其实不多，但是最容易想到的是用户名，注册一个用户。改包修改邮箱为xss语句</p>
<pre><code>{&quot;email&quot;:&quot;&lt;script&gt;alert(\&quot;xss3\&quot;)&lt;/script&gt;&quot;,&quot;password&quot;:&quot;123123&quot;,&quot;passwordRepeat&quot;:&quot;123123&quot;,&quot;securityQuestion&quot;:{&quot;id&quot;:1,&quot;question&quot;:&quot;Your eldest siblings middle name?&lt;script&gt;alert(/xss/)&lt;script&gt;&quot;,&quot;createdAt&quot;:&quot;2018-04-21T02:42:19.878Z&quot;,&quot;updatedAt&quot;:&quot;2018-04-21T02:42:19.878Z&quot;},&quot;securityAnswer&quot;:&quot;123123&quot;}
</code></pre><p>这个xss能在管理员页面弹出 <a href="http://192.168.209.146:3001/#/administration" target="_blank" rel="noopener">http://192.168.209.146:3001/#/administration</a> ，商品评论绕过不了，无法xss。</p>
<h3 id="XSS-Tier-3-XSS第三关"><a href="#XSS-Tier-3-XSS第三关" class="headerlink" title="XSS Tier 3 XSS第三关"></a>XSS Tier 3 XSS第三关</h3><blockquote>
<p>Perform a persisted XSS attack with <script>alert(“XSS”)</script> without using the frontend application at all. 执行存储型 XSS攻击<script>alert(“XSS”)</script>，根本不使用前端应用程序。</p>
</blockquote>
<p>前文我们说道发现了一个API接口<a href="http://192.168.209.146:3001/api/Products/9" target="_blank" rel="noopener">http://192.168.209.146:3001/api/Products/9</a>，并且这里可以修改描述信息，这里存在一个存储型的xss。使用 payload <code>{&quot;description&quot;:&quot;&lt;script&gt;alert(\&quot;xss\&quot;)&lt;/script&gt;&quot;}</code> 就阔以了，然而计分板没有显示我完成xss。</p>
<p>后来发现 api/Products 接口可以POST，这里POST一个新的商品也是可以XSS攻击的。注意需要用管理员的 Authorization 进行验证，否则会报401错误。</p>
<p><img src="https://i.loli.net/2018/04/21/5adaa9ed493fa.jpg" alt></p>
<p><img src="https://i.loli.net/2018/04/21/5adaaa44d92b6.jpg" alt></p>
<h3 id="XXE-Tier-1-XXE第一关"><a href="#XXE-Tier-1-XXE第一关" class="headerlink" title="XXE Tier 1 XXE第一关"></a>XXE Tier 1 XXE第一关</h3><blockquote>
<p>Retrieve the content of C:\Windows\system.ini or /etc/passwd from the server. 用XXE攻击搞到服务器的/etc/passwd</p>
</blockquote>
<p>构造xml文件如下</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; 
&lt;!DOCTYPE xxe [
&lt;!ELEMENT name ANY &gt;
&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;
&lt;root&gt;
&lt;name&gt;&amp;xxe;&lt;/name&gt;
&lt;/root&gt;
</code></pre><p>上传到投诉页面的上传点就过了，不过暂时不知道输出点哪儿</p>
<p><strong>update</strong>: 使用docker搭建时，XXE的关卡都不可用</p>
<h2 id="四星难度"><a href="#四星难度" class="headerlink" title="四星难度"></a>四星难度</h2><h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><blockquote>
<p>Change Bender’s password into slurmCl4ssic without using SQL Injection. 不用SQL注入修改Bender的密码</p>
</blockquote>
<p>只能是重置密码咯，到重置密码那儿抓个包，发现修改密码使用的是GET方式 <a href="http://192.168.209.146:3001/rest/user/change-password?current=123123123&amp;new=123123&amp;repeat=123123" target="_blank" rel="noopener">http://192.168.209.146:3001/rest/user/change-password?current=123123123&amp;new=123123&amp;repeat=123123</a></p>
<p>经过测试，发现<a href="http://192.168.209.146:3001/rest/user/change-password?new=123123&amp;repeat=123123" target="_blank" rel="noopener">http://192.168.209.146:3001/rest/user/change-password?new=123123&amp;repeat=123123</a>直接就可以返回200，无需原来的密码，此处代码应该是存在 current 关键字时才进行检测，没有就不检测。因此可以利用该链接做一个CSRF攻击。</p>
<p>然后通过SQL注入登录到bender的账户（……），模仿bender点击一下这个链接 <a href="http://192.168.209.146:3001/rest/user/change-password?new=slurmCl4ssic&amp;repeat=slurmCl4ssic" target="_blank" rel="noopener">http://192.168.209.146:3001/rest/user/change-password?new=slurmCl4ssic&amp;repeat=slurmCl4ssic</a> 触发即可。</p>
<p><img src="https://i.loli.net/2018/04/21/5adae8d3b8ad8.jpg" alt></p>
<p>一般的CSRF不会让用户发现，这里说明存在CSRF，具体怎么欺骗构造就不说了。</p>
<h3 id="Easter-Egg-Tier-1-amp-Easter-Egg-Tier-2"><a href="#Easter-Egg-Tier-1-amp-Easter-Egg-Tier-2" class="headerlink" title="Easter Egg Tier 1 &amp; Easter Egg Tier 2"></a>Easter Egg Tier 1 &amp; Easter Egg Tier 2</h3><blockquote>
<p>Find the hidden easter egg.Apply some advanced cryptanalysis to find the real easter egg. 找到隐藏的复活节彩蛋，使用高级点儿密码分析来寻找真正的复活节彩蛋。</p>
</blockquote>
<p>还记得FTP目录吗？在里面有个eastere.gg文件，同样使用%00截断即可。</p>
<p>文件下下来后里面有一段密文，明显是base64。转码完成后再用rot13即可找到路径，访问即可，这个页面还是很好玩的233</p>
<p><img src="https://i.loli.net/2018/04/21/5adaec31e9b69.jpg" alt></p>
<h3 id="Eye-Candy-秀色可餐"><a href="#Eye-Candy-秀色可餐" class="headerlink" title="Eye Candy 秀色可餐"></a>Eye Candy 秀色可餐</h3><blockquote>
<p>Travel back in time to the golden era of [image] web design. 回到这种老式设计的黄金年代</p>
</blockquote>
<p>意思让样式回到这种复古的样子。看这个hot图片的地址为<a href="http://192.168.209.146:3001/css/geo-bootstrap/img/hot.gif" target="_blank" rel="noopener">http://192.168.209.146:3001/css/geo-bootstrap/img/hot.gif</a></p>
<p>这个比较懵圈，看别人的WP是在其CSS框架网址<a href="https://github.com/divshot/geo-bootstrap" target="_blank" rel="noopener">https://github.com/divshot/geo-bootstrap</a>中提到了这个主题的 <code>bootstrap.css</code> 位于 <code>/swatch</code>上。因此打开JS控制台输入 <code>document.getElementById(&quot;theme&quot;).setAttribute(&quot;href&quot;, &quot;css/geo-bootstrap/swatch/bootstrap.css&quot;);</code>即可</p>
<p>这个主题还是很酷的233</p>
<p><img src="https://i.loli.net/2018/04/21/5adaee6f3ad0b.jpg" alt></p>
<h3 id="Forgotten-Developer-Backup-被遗忘的开发者备份"><a href="#Forgotten-Developer-Backup-被遗忘的开发者备份" class="headerlink" title="Forgotten Developer Backup 被遗忘的开发者备份"></a>Forgotten Developer Backup 被遗忘的开发者备份</h3><blockquote>
<p>Access a developer’s forgotten backup file. </p>
</blockquote>
<p>不用说也知道在哪儿了吧，和前一关一样的地方。方法一样是%00截断下载。</p>
<h3 id="Login-Bjoern-登录Bjoern"><a href="#Login-Bjoern-登录Bjoern" class="headerlink" title="Login Bjoern 登录Bjoern"></a>Login Bjoern 登录Bjoern</h3><blockquote>
<p>Log in with Bjoern’s user account without previously changing his password, applying SQL Injection, or hacking his Google account.<br>要求不能通过改密码、sql注入和社工登录。</p>
</blockquote>
<p>之前在折腾xss的时候，发现了一个api接口，返回的是用户的数据，包括密码，所以就放到repeater找Bjoern，看到其密码为32位的，第一个想到的是md5，然而查不到……</p>
<p><img src="https://i.loli.net/2018/04/21/5adaefecc5e43.jpg" alt></p>
<p>这题解不出来，看了WP，是Bjoern(该项目的编写者)通过谷歌的oauth登陆，由于本地搭建的应用是无法跟谷歌oauth互动，所以可以到 <a href="http://demo.owasp-juice.shop/" target="_blank" rel="noopener">http://demo.owasp-juice.shop/</a> 中去做这个挑战。该作者的email是<a href="mailto:`bjoern.kimminich@googlemail.com" target="_blank" rel="noopener">`bjoern.kimminich@googlemail.com</a><code>![](https://i.loli.net/2018/12/13/5c1250fa67188.jpg)
在main.js中搜索oauth，看一下谷歌账号登陆的处理过程：
![](https://i.loli.net/2018/12/13/5c12517bf0e69.jpg)
password的处理是</code>btoa(n.email.split(“”).reverse().join(“”))<code>，btoa()函数就是base64的意思，所以这里密码只是根据邮箱变化而得。直接在console执行</code>btoa(“<a href="mailto:bjoern.kimminich@googlemail.com" target="_blank" rel="noopener">bjoern.kimminich@googlemail.com</a>“.split(“”).reverse().join(“”))<code>，获得密码</code>bW9jLmxpYW1lbGdvb2dAaGNpbmltbWlrLm5yZW9qYg==`，使用该账户和密码登陆即可。</p>
<h3 id="Misplaced-Signature-File-错位的siem签名文件。"><a href="#Misplaced-Signature-File-错位的siem签名文件。" class="headerlink" title="Misplaced Signature File 错位的siem签名文件。"></a>Misplaced Signature File 错位的siem签名文件。</h3><blockquote>
<p>Access a misplaced SIEM signature file.访问错位的siem签名文件。</p>
</blockquote>
<p>FTP下的 <code>suspicious_errors.yml</code>文件，同样%00截断。</p>
<h3 id="NoSQL-Injection-Tier-1-NoSQL注入第一关"><a href="#NoSQL-Injection-Tier-1-NoSQL注入第一关" class="headerlink" title="NoSQL Injection Tier 1 NoSQL注入第一关"></a>NoSQL Injection Tier 1 NoSQL注入第一关</h3><blockquote>
<p>Let the server sleep for some time. (It has done more than enough hard work for you) 让服务器休眠一段时间。</p>
</blockquote>
<p>重点在于能找到该rest接口，存在在评论<code>/rest/product/3/reviews</code>处，商品id参数可控，此处可以执行命令<code>/rest/product/sleep(999)/reviews</code>，相当于一个dos了。</p>
<h3 id="NoSQL-Injection-Tier-2"><a href="#NoSQL-Injection-Tier-2" class="headerlink" title="NoSQL Injection Tier 2"></a>NoSQL Injection Tier 2</h3><blockquote>
<p>Update multiple product reviews at the same time.</p>
</blockquote>
<p>与上一题同样的接口，使用NoSQL注入最简单的一个payload，利用正则进行注入<code>{ &quot;id&quot;: { &quot;$ne&quot;: -1 }, &quot;message&quot;: &quot;NoSQL Injection!&quot; }</code></p>
<h3 id="Redirects-Tier-2-重定向第二关"><a href="#Redirects-Tier-2-重定向第二关" class="headerlink" title="Redirects Tier 2 重定向第二关"></a>Redirects Tier 2 重定向第二关</h3><blockquote>
<p>Wherever you go, there you are.</p>
</blockquote>
<p>在各个页面搜索一下<code>redirect</code>，在关于我们-<code>Fork me on github</code>的label上找到了该问题：<br><img src="https://i.loli.net/2018/12/14/5c1327b4d4eee.jpg" alt></p>
<p>修改to参数重定向到baidu，返回406报错，此处同样可以完成一星难度的<em>Error Handling</em><br><img src="https://i.loli.net/2018/12/14/5c132835b1bea.jpg" alt></p>
<p>这里的知识点是重定向URL的白名单问题，只要<code>to</code>参数中有白名单域名就可以过，此题有多种解法，使用 <code>/redirect?to=https://www.baidu.com/?a=https://github.com/bkimminich/juice-shop</code> 可过</p>
<h3 id="Reset-Bender’s-Password-重置Bender的密码"><a href="#Reset-Bender’s-Password-重置Bender的密码" class="headerlink" title="Reset Bender’s Password 重置Bender的密码"></a>Reset Bender’s Password 重置Bender的密码</h3><blockquote>
<p>Reset Bender’s password via the Forgot Password mechanism with the original answer to his security question.<br>通过忘记的密码机制重置Bender密码</p>
</blockquote>
<p>在四星难度里已经使用过CSRF重置了Bender的密码，但是一个知识点放有两道题比较奇怪，之后对了一下wp，发现这题还可以有别的解，不过同样也是美国人的思路。</p>
<ol>
<li>首先说到Bender，美国人第一个想到的应该是这个动漫角色 <a href="https://en.wikipedia.org/wiki/Bender_(Futurama" target="_blank" rel="noopener">Bender</a>)</li>
<li>用重置密码功能，邮箱我们已经知道是<a href="mailto:`bender@juice-sh.op" target="_blank" rel="noopener">`bender@juice-sh.op</a>`，看密码重置的问题是<br><img src="https://i.loli.net/2018/12/14/5c1346f06e294.jpg" alt></li>
<li>意思是成年后第一份工作的公司是什么，在Bender的wiki中可以看到他现在工作的公司是<code>Futurama</code>，在角色传记里面提到了是<a href="https://futurama.fandom.com/wiki/Suicide_booth" target="_blank" rel="noopener">FUTURAMA wiki-Suicide booth</a></li>
<li>在该wiki里面写到了最重要的一个品牌就是<code>Stop&#39;n&#39;Drop</code><br><img src="https://i.loli.net/2018/12/14/5c13531f29039.jpg" alt></li>
<li>填入该公司名称就可以重置了</li>
<li>总结：这个过程还是培养一个人的社工能力吧，就是国家思维不一样导致理解有点困难，但是思路还是可以学习的。</li>
</ol>
<h3 id="Typosquatting-Tier-1-域名注册第一关"><a href="#Typosquatting-Tier-1-域名注册第一关" class="headerlink" title="Typosquatting Tier 1 域名注册第一关"></a>Typosquatting Tier 1 域名注册第一关</h3><blockquote>
<p>Inform the shop about a typosquatting trick it has become victim of. (Mention the exact name of the culprit) 告知商店他们的库存在typosquatting问题</p>
</blockquote>
<p>看记分板的提示是说之前的开发者文件泄露，该题还是翻了别人的WP。<br>看<code>package.json.bak</code>里面有个 <a href="https://www.npmjs.com/package/epilogue-js" target="_blank" rel="noopener">epilogue-js</a> ，这个就是typosquatting的库。提交<code>epilogue-js</code>到客户反馈提交即可。</p>
<p>该题的关键点是知道<code>typosquatting</code>是什么东西：</p>
<blockquote>
<p>攻击者使用 typosquatting 的方法来上传这些恶意库到 PyPI 平台上，他们上传的恶意库的名字和那些正常的库的名字非常相似，很容易让人混淆，比如将”urlib” 写成 “urllib”。</p>
</blockquote>
<h3 id="User-Credentials"><a href="#User-Credentials" class="headerlink" title="User Credentials"></a>User Credentials</h3><blockquote>
<p>Retrieve a list of all user credentials via SQL Injection</p>
</blockquote>
<p>要求用SQL注入搞到所有用户信息。两个SQL注入点，用搜索框的的注入点就好啦，有回显：<code>qwert&#39;)) UNION SELECT &#39;1&#39;, id, email, password, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39; FROM Users--</code></p>
<h3 id="Vulnerable-Library-有漏洞的库"><a href="#Vulnerable-Library-有漏洞的库" class="headerlink" title="Vulnerable Library 有漏洞的库"></a>Vulnerable Library 有漏洞的库</h3><blockquote>
<p>Inform the shop about a vulnerable library it is using. (Mention the exact library name and version in your comment) </p>
</blockquote>
<p><code>package.json.bak</code> 的 <code>sanitize-html</code> 指定了固定的版本：<br><img src="https://i.loli.net/2018/12/14/5c1350439e9e3.jpg" alt></p>
<p>这个漏洞就体现在下一题的持久型xss。</p>
<h3 id="XSS-Tier-4"><a href="#XSS-Tier-4" class="headerlink" title="XSS Tier 4"></a>XSS Tier 4</h3><blockquote>
<p>Perform a persisted XSS attack with <script>alert(“XSS”)</script> bypassing a server-side security mechanism. 持久型xss</p>
</blockquote>
<p>这个题有多个解</p>
<ol>
<li><code>联系我们</code>处存在的一个持久型xss，payload为 <code>&lt;&lt;script&gt;Foo&lt;/script&gt;script&gt;alert(&quot;XSS&quot;)&lt;&lt;/script&gt;/script&gt;</code></li>
<li>注册User的api处，<code>email</code>参数过滤不严可以造成持久型XSS，administrator登陆后，由于页面有用户信息会直接xss。</li>
</ol>
<h2 id="五星难度"><a href="#五星难度" class="headerlink" title="五星难度"></a>五星难度</h2><h3 id="CAPTCHA-Bypass-验证码绕过"><a href="#CAPTCHA-Bypass-验证码绕过" class="headerlink" title="CAPTCHA Bypass 验证码绕过"></a>CAPTCHA Bypass 验证码绕过</h3><blockquote>
<p>Submit 10 or more customer feedbacks within 10 seconds. 在10s内提交10+顾客反馈</p>
</blockquote>
<p>一个很入门的脚本编写题，需要在10秒内提交10个以上的反馈。chrome开F12提交一个普通的反馈，查看<code>Network</code>，请求captcha返回的数据为<code>{&quot;captchaId&quot;:17,&quot;captcha&quot;:&quot;10+4+4&quot;,&quot;answer&quot;:&quot;18&quot;}</code>，captcha结果妥妥地躺在返回包中。</p>
<p>再看提交反馈的包，验证码取返回验证码包中的<code>answer</code>，<code>captchaId</code>即验证码id。</p>
<p><img src="https://i.loli.net/2018/12/18/5c18b1a2dbaaf.jpg" alt></p>
<p>写脚本过即可，注意json的处理。</p>
<pre><code class="Python">import requests
import json

post_url = &#39;http://192.168.14.142:3000/api/Feedbacks&#39;
captcha_url = &#39;http://192.168.14.142:3000/rest/captcha/&#39;
headers = {
    &#39;Content-Type&#39;: &#39;application/json;charset=UTF-8&#39;,
    &#39;Cookie&#39;: &#39;cookieconsent_status=dismirequests; continueCode=o1o17zpBWv3DENkqXL89JQYOA6gHbuXH8clgdwM2ZV4jgKnxR5rmyabPle6j; io=6xLNWoRR4wKbTGiEAAAK&#39;
}
data = {&quot;comment&quot;: &quot;terrrible&quot;, &quot;rating&quot;: 1, &quot;captcha&quot;: &quot;55&quot;, &quot;captchaId&quot;: 5}

for _ in range(15):
    captcha = requests.get(captcha_url).json()
    data[&#39;captcha&#39;] = captcha[&#39;answer&#39;]
    data[&#39;captchaId&#39;] = captcha[&#39;captchaId&#39;]
    print(requests.post(post_url, data=json.dumps(data), headers=headers, timeout=1).text)
</code></pre>
<h3 id="Extra-Language-额外的语言"><a href="#Extra-Language-额外的语言" class="headerlink" title="Extra Language 额外的语言"></a>Extra Language 额外的语言</h3><blockquote>
<p>Retrieve the language file that never made it into production. 找到一个不在生产环境出现过的语言文件</p>
</blockquote>
<p>妥妥的脑洞题。在Burp中看浏览记录，语言文件的目录在<code>/i18n</code>下，文件名为<code>/i18n/en.json</code>，根据命名规则，用两位字母+下划线+两位字母爆破的话量太大了……</p>
<p><img src="https://i.loli.net/2018/12/18/5c18b0e985335.jpg" alt></p>
<p>还是看了一下别人的writeup，原来是<code>tlh_AA.json</code>，克林贡语。还是学习一下Intruder的用法吧：</p>
<ol>
<li>选择<code>Cluster bomb</code>模式：</li>
</ol>
<p><img src="https://i.loli.net/2018/12/18/5c18ba25582ea.jpg" alt></p>
<ol start="2">
<li>在<code>Payloads</code>中选择<code>Payload Type</code>为<code>Brute forcer</code>爆破模式，<code>min length</code>最小长度选择为2，<code>max length</code>最大长度选择为2即可。</li>
</ol>
<p><img src="https://i.loli.net/2018/12/18/5c18ba5960416.jpg" alt></p>
<h3 id="JWT-Issues-Tier-1-JWT问题第一关"><a href="#JWT-Issues-Tier-1-JWT问题第一关" class="headerlink" title="JWT Issues Tier 1 JWT问题第一关"></a>JWT Issues Tier 1 JWT问题第一关</h3><blockquote>
<p>Forge an essentially unsigned JWT token that impersonates the (non-existing) user <a href="mailto:jwtn3d@juice-sh.op" target="_blank" rel="noopener">jwtn3d@juice-sh.op</a>. 伪造一个基本上未签名的JWT token，仿冒（不存在的）用户<a href="mailto:jwtn3d@juice-sh.op" target="_blank" rel="noopener">jwtn3d@juice-sh.op</a>。</p>
</blockquote>
<p>先解释一下什么叫JWT：</p>
<blockquote>
<p>JWT是json web token缩写。它将用户信息加密到token里，服务器不保存任何用户信息。服务器通过使用保存的密钥验证token的正确性，只要正确即通过验证。优点是在分布式系统中，很好地解决了单点登录问题，很容易解决了session共享的问题。缺点是无法作废已颁布的令牌/不易应对数据过期。</p>
</blockquote>
<p>以下是解题过程</p>
<ol>
<li>抓登陆的包，返回token就是JWT↓</li>
</ol>
<p><img src="https://i.loli.net/2018/12/18/5c18bf2c3a978.jpg" alt></p>
<p>对JWT解码最常用的是到 <a href="https://jwt.io/" target="_blank" rel="noopener">jwt.io</a>  解密，采用默认的<code>RS256</code>算法即可解码 。Decoded处的Header说明了采用的算法<code>alg</code>和Token类型<code>typ</code>，Payload处则是该token解码后的内容，Verified signature是签名，这三项分别对应Encoded处三处以<code>.</code>号分割的不同颜色的payload。↓</p>
<p><img src="https://i.loli.net/2018/12/18/5c18c63bdb99f.jpg" alt></p>
<ol start="2">
<li>这道题考察点在于，JWT的Header和Payload是通过base64编码得到，意思是Header和Payload很容易被伪造，而不同的算法只是用于对数据进行签名校验而已。因此，如果服务器不检验签名或检验签名的流程有问题，那么直接解码Payload验证用户信息则会造成漏洞。所以，该题我们需要仿冒用户<a href="mailto:`jwtn3d@juice-sh.op" target="_blank" rel="noopener">`jwtn3d@juice-sh.op</a><code>的话需要修改Header的算法为</code>none<code>，修改Payload的用户邮箱和Exp(过期账户时间，调大一点就可以)，将header和payload进行base64编码后，用</code>.<code>连接Header和Payload，注意最后面多加一个</code>.`，用于标识签名为空：↓</li>
</ol>
<pre><code>eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6eyJpZCI6MSwiZW1haWwiOiJqd3RuM2RAanVpY2Utc2gub3AiLCJwYXNzd29yZCI6IjAxOTIwMjNhN2JiZDczMjUwNTE2ZjA2OWRmMThiNTAwIiwiY3JlYXRlZEF0IjoiMjAxOC0wOC0xMiAwNzo1MzozOC4wNjQgKzAwOjAwIiwidXBkYXRlZEF0IjoiMjAxOC0wOC0xMiAwNzo1MzozOC4wNjQgKzAwOjAwIn0sImlhdCI6MTUzNDA2MDUzOSwiZXhwIjoxNTU0MDc4NTM5fQ.
</code></pre><p><img src="https://i.loli.net/2018/12/18/5c18e65baa15e.jpg" alt></p>
<ol start="3">
<li>使用<code>Modify Header</code>修改<code>Authorization</code>请求头，注意该请求头前面有<code>Bearer</code>前缀。由于服务器端会验证算法，服务端接收到我们构造的如下Payload后，解码得到该Auth算法为<code>None</code>，服务器运行算法<code>None</code>（就是什么也没有）后得出的签名结果为<code>None</code>，与请求的签名（为空）对比，验证通过！这就达到了我们伪造JWT的目的。↓</li>
</ol>
<p><img src="https://i.loli.net/2018/12/18/5c18e4a20e393.jpg" alt></p>
<h3 id="Login-CISO-登录CISO"><a href="#Login-CISO-登录CISO" class="headerlink" title="Login CISO 登录CISO"></a>Login CISO 登录CISO</h3><blockquote>
<p>Exploit OAuth 2.0 to log in with the Chief Information Security Officer’s user account. 利用OAuth 2.0登录CSO的帐户</p>
</blockquote>
<p>还是从OAuth说起，OAuth是一种授权框架，OAuth2协议定义了一套用户、第三方服务和存储着用户数据的平台之间的交互规则，可以使得用户无需将自己的用户名和密码暴露给第三方，即可使第三方应用获取用户在该平台上的数据，最常见的场景便是现在互联网上的各种使用XXX账号登录，JWT算是其中的一种认证机制。</p>
<p>以下是解题过程</p>
<ol>
<li><p>如果你还记得前面Bjoern谷歌登陆，密码是base64(邮箱)的那道题的话，可以回去翻看一下js文件，这里使用到的就是OAuth登陆方式。在前面的SQL注入中，我们拉取到了所有用户的列表，其中有个邮箱为<a href="mailto:`ciso@juice-sh.op" target="_blank" rel="noopener">`ciso@juice-sh.op</a>`即为CISO的邮箱。</p>
</li>
<li><p>在Juice Shop里面，登陆功能中有个记住用户的勾选，返回的参数中含有一个<code>umail</code>，并且之后的请求中请求头会有一个<code>X-User-Email</code>，本地Cookie中也有一个email的cookie<br><img src="https://i.loli.net/2018/12/19/5c19bdcd9e4da.jpg" alt><br><img src="https://i.loli.net/2018/12/18/5c18ea88b9bb5.jpg" alt><br><img src="https://i.loli.net/2018/12/19/5c19c27f2b053.jpg" alt></p>
</li>
<li><p>因此我们使用<a href="mailto:`ciso@juice-sh.op" target="_blank" rel="noopener">`ciso@juice-sh.op</a>`登陆，密码任意，即使登陆失败后</p>
</li>
<li><p>做到这里歇菜了，看别人WP可以通过两种方式走Oauth认证：</p>
<ol>
<li><p>在 <a href="http://demo.owasp-juice.shop" target="_blank" rel="noopener">demo.owasp-juice.shop</a> 上勾选记住用户，使用自己的google账户登陆，然后修改X-User-Email字段为CISO的邮箱即可<br><img src="https://i.loli.net/2018/12/19/5c19b2f4299e9.jpg" alt></p>
</li>
<li><p>在Login的时候</p>
</li>
</ol>
</li>
</ol>
<p>无法复现</p>
<h3 id="RCE-Tier-1-RCE第一关"><a href="#RCE-Tier-1-RCE第一关" class="headerlink" title="RCE Tier 1 RCE第一关"></a>RCE Tier 1 RCE第一关</h3><blockquote>
<p>Perform a Remote Code Execution that would keep a less hardened application busy forever. 执行远程执行代码，让一个持久性较差的应用程序处于繁忙状态。</p>
</blockquote>
<ol>
<li>在目录探测时候发现了<code>/api-docs/</code>，该目录是商城API的文档</li>
<li>该处可以直接编辑请求表单执行，看到这里就想到可能存在代码执行的问题。<br><img src="https://i.loli.net/2018/12/26/5c22d486619d3.jpg" alt></li>
</ol>
<p>请求JSON如下，并且还需要点击<code>Authorize</code>按钮，输入自己的<code>bearerAuth</code>（就是前面说到的JWT token）进行身份认证</p>
<pre><code>{
  &quot;cid&quot;: &quot;JS0815DE&quot;,
  &quot;orderLines&quot;: [
    {
      &quot;productId&quot;: 8,
      &quot;quantity&quot;: 500,
      &quot;customerReference&quot;: &quot;PO0000001&quot;
    }
  ],
  &quot;orderLinesData&quot;: &quot;[{\&quot;productId\&quot;: 12,\&quot;quantity\&quot;: 10000,\&quot;customerReference\&quot;: [\&quot;PO0000001.2\&quot;, \&quot;SM20180105|042\&quot;],\&quot;couponCode\&quot;: \&quot;pes[Bh.u*t\&quot;},{\&quot;productId\&quot;: 13,\&quot;quantity\&quot;: 2000,\&quot;customerReference\&quot;: \&quot;PO0000003.4\&quot;}]&quot;
}
</code></pre><ol start="3">
<li><p>点击<code>Execute</code>，可以看到在执行的为curl命令，JSON的<code>orderLinesData</code>带入了命令，此处存在代码执行的问题，但是利用不会，所以用了别人的Payload：<br><img src="https://i.loli.net/2018/12/26/5c22d68ca4c6c.jpg" alt></p>
</li>
<li><p>替换JSON为 <code>{&quot;orderLinesData&quot;: &quot;(function dos() { while(true); })()&quot;}</code>，作用是使该命令进入死循环，发出后服务器返回500，该处pass。</p>
</li>
</ol>
<h3 id="Reset-Bjoern’s-Password-重置Bjoern的密码"><a href="#Reset-Bjoern’s-Password-重置Bjoern的密码" class="headerlink" title="Reset Bjoern’s Password 重置Bjoern的密码"></a>Reset Bjoern’s Password 重置Bjoern的密码</h3><blockquote>
<p>Reset Bjoern’s password via the Forgot Password mechanism with the original answer to his security question. 通过忘记密码机制重置Bjoern的密码，并附上他的安全问题的原始答案。</p>
</blockquote>
<h3 id="Reset-Morty’s-Password-重置Morty的密码"><a href="#Reset-Morty’s-Password-重置Morty的密码" class="headerlink" title="Reset Morty’s Password 重置Morty的密码"></a>Reset Morty’s Password 重置Morty的密码</h3><blockquote>
<p>Reset Morty’s password via the Forgot Password mechanism with his obfuscated answer to his security question. 通过忘记密码机制重置Morty的密码，并对其安全问题进行模糊回答。</p>
</blockquote>
<h3 id="Retrieve-Blueprint-检索Blueprint"><a href="#Retrieve-Blueprint-检索Blueprint" class="headerlink" title="Retrieve Blueprint 检索Blueprint"></a>Retrieve Blueprint 检索Blueprint</h3><blockquote>
<p>Deprive the shop of earnings by downloading the blueprint for one of its products. 通过下载其中一个产品的Blurprint来移除商店的收入。</p>
</blockquote>
<h3 id="Typosquatting-Tier-2-注册近似域名-第二关"><a href="#Typosquatting-Tier-2-注册近似域名-第二关" class="headerlink" title="Typosquatting Tier 2 注册近似域名 第二关"></a>Typosquatting Tier 2 注册近似域名 第二关</h3><blockquote>
<p>Inform the shop about a more literal instance of typosquatting it fell for. (Mention the exact name of the culprit) 告知商店一个更为文字化的域名抢注案例。</p>
</blockquote>
<h3 id="XXE-Tier-2-XXE第二关"><a href="#XXE-Tier-2-XXE第二关" class="headerlink" title="XXE Tier 2 XXE第二关"></a>XXE Tier 2 XXE第二关</h3><blockquote>
<p>Give the server something to chew on for quite a while. 上传一个文件让服务器繁忙。</p>
</blockquote>
<h2 id="六星难度"><a href="#六星难度" class="headerlink" title="六星难度"></a>六星难度</h2><p>累了，之后持续更新补上</p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png"></a><br>本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可。
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="https://leezj9671.github.io/20180319/OWASP Juice Shop writeup.html">https://leezj9671.github.io/20180319/OWASP Juice Shop writeup.html</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 Gitalk -->
<div id="gitalk-comment">
    <!-- Gitalk 评论框 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script>
    var gitalk = new Gitalk({
            clientID: 'ad451cc3feb9601c7fb1',
            clientSecret: '80a6439f8f871afa1e07a8a4a00d0aafce1f8494',
            repo: 'Leezj9671.github.io',
            owner: 'Leezj9671',
            admin: ['Leezj9671'],
            id: decodeURI(location.pathname),
            // facebook-like distraction free mode
            distractionFreeMode: false
        })
   gitalk.render('gitalk-container')
</script>
</div>
<style>
    #gitalk-comment {
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/20180329/LDAP安装和基本管理手记.html" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/20180224/Gitpages绑定域名及启用HTTPS.html" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="n3ver's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        leezj9671@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: leezj9671@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2019/04/">四月 2019<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">二月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/01/">一月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">1</span></a>
            </li></ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/CTF/">CTF<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux/">Linux<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/内网渗透/">内网渗透<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/前端/">前端<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/博客搭建/">博客搭建<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/安卓/">安卓<span class="sidebar_archives-count">1</span></a>
            </li></ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签">
                
                    <i class="material-icons sidebar-material-icons">loyalty</i>
                
                标签
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">timeline</i>
                
                时间轴
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">13</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material" class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/Leezj9671" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/liyugui/activities" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2017&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>NeverSec的博客 | 安全不止
            
                <br>
                
                    <a href="http://www.miitbeian.gov.cn" rel="nofollow">粤ICP备19002199号-1</a>
                
            

            
            <!-- All Site UV -->
            <br>
            <span id="busuanzi_container_site_uv">
                已经有<span id="busuanzi_value_site_uv"></span>个小伙伴来看过
            </span>|
            <span id="busuanzi_container_site_pv">
                总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>|
            
            本博客总字数<span class="post-count">20.4k</span>
        </div>
        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- GitTalk -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
